<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Mengd@</title><meta name="author" content="Mengd@"><meta name="copyright" content="Mengd@"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta property="og:type" content="website">
<meta property="og:title" content="Mengd@">
<meta property="og:url" content="https://men9da.cn/page/2/index.html">
<meta property="og:site_name" content="Mengd@">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/15/s010Z4.jpg">
<meta property="article:author" content="Mengd@">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ax1x.com/2021/01/15/s010Z4.jpg"><link rel="shortcut icon" href="https://s3.ax1x.com/2021/01/15/s0eSiT.png"><link rel="canonical" href="https://men9da.cn/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: {"text":"Mengd@,Flag,CTF,Web,Misc,Pwn,N0p3,Nysec","fontSize":"15px"},
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-07-08 16:24:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Mengd@" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://s3.ax1x.com/2021/01/15/s010Z4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Mengd@</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site-title">Mengd@</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/01/27/Struts2-S005%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 005详细分析">     <img class="post_bg" src="https://s4.ax1x.com/2022/01/27/7jwhwV.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Struts2-S2 005详细分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/27/Struts2-S005%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 005详细分析">Struts2-S2 005详细分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-27T06:08:33.000Z" title="发表于 2022-01-27 14:08:33">2022-01-27</time></span></div><div class="content">前言:注:如果你跟我一样是个菜鸡并且没有看过S2-003,那么强烈建议去看一下S2-003的调用过程,我也有写,可以先看一下
昨天刚啃完了struts2-s003,第一次分析觉得超级复杂花费了大量的时间,同时也对整个解析流程熟悉了很多,听说S2-005是S2-003的绕过,不妨趁热打铁,直接分析一下.
注:以下内容以及思维逻辑站在一个刚开始接触java审计的菜鸡身上,同时也能记录我的思维进步过程
由于熟悉S2-003的调用过程,当我首次看网上各类文章的时候,分为两种
第一种:简单介绍一下这个是s2-003的绕过,然后提了一下unicode编码绕过,然后就说官方是通过增加一个沙盒模式进行修复,然后就是下载现成环境打一发payload结束
第二种:一些大佬们直接从代码层面分析代码的改动,首先新增了几个接口,由xxx实现,解释了一大波新的内容,新增了xxxx方法,这对于我这种开发经验不足且刚接触java审计的菜鸡无疑是毁灭性的打击,但是,既然是针对S2-003的绕过,那我就饶过这个本质而言,先尝试自己分析为什么旧的payload不能执行了分析完后没想到并没有这么复杂并且我自己在没有看别人发的 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/01/26/Struts2-S003%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 003详细分析">     <img class="post_bg" src="https://s4.ax1x.com/2022/01/27/7jwhwV.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Struts2-S2 003详细分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/26/Struts2-S003%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 003详细分析">Struts2-S2 003详细分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-26T03:10:30.000Z" title="发表于 2022-01-26 11:10:30">2022-01-26</time></span></div><div class="content">前言:S2-003是第我审计的第二个java漏洞,其中核心还是围绕着OGNL表达式注入的利用,在我的”Struts2-S001”中以一种初学者的理解讲解了ognl表达式的用法,如果说S2-001的作用是让我大概了解了Struts2的执行流程,那么这次的S2-003让我深入了解了ognl的执行原理,网上对于S2-003的解释十分有限,内容不相同的文章就没有几篇,其中有一些我认为很复杂的概念没有讲出来,导致整个利用原理让人摸不着头脑,为什么payload形如(one)(two)?这些括号的意义是什么?为什么ognl就会解析one,而不会解析two呢,为什么(one)(two)(three)甚至是(one)(two)(three)(four)…也是可以成功执行的呢?这涉及以下几个核心概念,本篇文章会在恰当的地方进行解释.
1.什么是ASTchain,他长什么样?
2.ognl是如何解析各种类型的AST的
3.payload被解析为ASTchain后是什么一个形式
4.payload的解析顺序
0X01:利用过程&amp;环境搭建先写利用过程
12GET &#x2F;Struts2-s003& ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/01/14/UDF%E6%8F%90%E6%9D%83/" title="UDF提权">     <img class="post_bg" src="https://z3.ax1x.com/2021/05/22/gqkm3F.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UDF提权"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/14/UDF%E6%8F%90%E6%9D%83/" title="UDF提权">UDF提权</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-14T08:32:56.000Z" title="发表于 2022-01-14 16:32:56">2022-01-14</time></span></div><div class="content">UDF（user defined function)mysql自带的函数有user(),version()等,除了自带的函数,用户可以自定义一些函数方便在查询的时候使用它们,我们把这些函数称之为UDF(user defined function)
用法:
1create function function_name returns &#123;string|integer|real|decimal&#125; routine_body

function_name:函数名
routine_body:由合法的sql语句构成的函数体
举个例子:
 查询user表id为1的username我们应该这么写:
1select username from user where id &#x3D; 1;

执行结果如下:
12345+----------+| username |+----------+| mengda   |+----------+

这个时候我们自定义一个函数
1create function getUserName(userid int) returns varchar(30) ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/01/09/Struts2-S001%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 001详细分析">     <img class="post_bg" src="https://s4.ax1x.com/2022/01/27/7jwhwV.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Struts2-S2 001详细分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/09/Struts2-S001%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="Struts2-S2 001详细分析">Struts2-S2 001详细分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-09T07:03:04.000Z" title="发表于 2022-01-09 15:03:04">2022-01-09</time></span></div><div class="content">前言:本篇文章是站在一个只会一丁点java基础,没有任何Java开发经验的的菜鸡眼中去完成的.所设计知识点繁多,杂乱,从Struts2的执行流程到漏洞Rce,适合小白看.本次分析的是Struts2-S001,版本为2.0.8
0X01:OGNL表达式OGNL 是 Object Graphic Navigation Language (对象图导航语言)的缩写，是一个开源项目。它是一种功能强大的表达式语言，通过它简单一致的表达式语法，可以存取对象的任意属性，调用对象的方法。
Struts2 中支持以下几种表达式语言：OGNL、JSTL、Groovy、Velocity。Struts 框架使用 OGNL 作为默认的表达式语言。
为什么这里要提到OGNL表达式呢?因为就是OGNL存在可以执行java代码的函数,而Struts2使用了OGNL进行开发,但是在这个过程中由于疏忽导致用户可控OGNL处理的表达式数据从而造成注入.
打个比方,就好比php里面开发者用了eval()函数,但是呢由于开发不严谨导致eval()函数的参数被用户可控了,那肯定就直接RCE了.
OGNL表达式到底怎么用呢?我们来举 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/11/29/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E4%BF%A1%E5%91%BCoa/" title="代码审计:信呼oa">     <img class="post_bg" src="https://s3.ax1x.com/2021/02/04/y3fVsO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="代码审计:信呼oa"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/11/29/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E4%BF%A1%E5%91%BCoa/" title="代码审计:信呼oa">代码审计:信呼oa</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-11-29T14:21:29.000Z" title="发表于 2021-11-29 22:21:29">2021-11-29</time></span></div><div class="content">这个忘记写了,先留着…
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/05/25/%E5%88%A9%E7%94%A8SSRF%E6%89%93Redis/" title="利用SSRF打Redis">     <img class="post_bg" src="https://s3.ax1x.com/2021/02/04/y3fVsO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用SSRF打Redis"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/25/%E5%88%A9%E7%94%A8SSRF%E6%89%93Redis/" title="利用SSRF打Redis">利用SSRF打Redis</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-25T06:18:58.000Z" title="发表于 2021-05-25 14:18:58">2021-05-25</time></span></div><div class="content">SSRF&amp;Gopher协议最近研究通过Gopher协议构造post，get请求来攻击内网的一些服务。遂继续研究Gopher协议，Gopher协议不仅可以进行post，get请求的修改，还能构造TCP数据流攻击一些内网的服务。如redis，mysql等。这次分析通过SSRF和Gopher协议攻击redis，以及对攻击原理进行分析。
未授权的Redis未授权redis服务即不需要密码即可使用的redis服务，这种暴露在网络中而且不需要授权的服务非常危险，可以直接构造payload执行文件写入，反弹shell等危险操作。
安装redis后使用root用户启动。(手动关闭redis后重新使用redis-server命令启动，不然默是redis用户，没有文件写入权限)
使用工具生成payload，直接打。




成功写入：




流量包分析抓出攻击流量包进行流量分析
1tcpdump -i eth0 port 6379 -W 1234.pcap



流量包结构如上，redis使用了RESP协议进行通信的。该协议内容如下：


截取了流量包前半部分分条解析RESP协议
1234567 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/05/23/%E7%BE%8E%E5%9B%A2CTF-2021-web-writeup/" title="美团CTF 2021 web writeup">     <img class="post_bg" src="https://s3.ax1x.com/2021/02/04/y3fVsO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="美团CTF 2021 web writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/23/%E7%BE%8E%E5%9B%A2CTF-2021-web-writeup/" title="美团CTF 2021 web writeup">美团CTF 2021 web writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-23T05:55:44.000Z" title="发表于 2021-05-23 13:55:44">2021-05-23</time></span></div><div class="content">web1 sql

登录页面，首先fuzz测试一下过滤关键字。


过滤了select ascii substr if 各种比较，引号。而开放了regexp，/**/等特殊字段。不考虑bool盲注，时间盲注。考虑
regexp正则盲注，关于正则盲注可以去我的sql总结中看。
思路：正则盲注，使用16进制编码绕过引号限制，使用/**/绕过空格限制。使用||绕过OR限制，而\用来转义引号从而使其闭合。
payload：
1username&#x3D;admin\&amp;password&#x3D;||password&#x2F;**&#x2F;regexp&#x2F;**&#x2F;0x5e542a#

脚本Python3：
1234567891011121314151617import requestsimport stringurl &#x3D; &quot;http:&#x2F;&#x2F;eci-2ze10cbxg19yyr2ee727.cloudeci1.ichunqiu.com&#x2F;&quot;ALLSTR &#x3D; string.ascii_lowercase+s ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/05/19/%E5%B8%B8%E8%A7%81SQL%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="常见SQL注入总结,原理分析">     <img class="post_bg" src="https://z3.ax1x.com/2021/05/22/gqkm3F.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常见SQL注入总结,原理分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/19/%E5%B8%B8%E8%A7%81SQL%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="常见SQL注入总结,原理分析">常见SQL注入总结,原理分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-19T03:27:08.000Z" title="发表于 2021-05-19 11:27:08">2021-05-19</time></span></div><div class="content">[TOC]
sql常见运算符，注释符。众所周知sql存在注入的本质是在代码层面sql语句存在拼接，过滤不严谨等，用户可以通过控制sql语句从而达到注入的目的。在进行sql总结时先总结下常见的sql符号。
注释符123456单行注释#--多行注释&#x2F;*...*&#x2F;

算数运算符123456算术运算符+(加)-(减)*(乘)&#x2F;(除)%(取模)

比较运算符1234567&#x3D;(等于)&gt;(大于)&lt;(小于)&lt;&gt;(不等于)&gt;&#x3D;(大于等于)&lt;&#x3D;(小于等于)!&#x3D;(不等于)

逻辑运算符123AND(两边为真返回真)OR(两边为假返回假)NOT(对布尔表达式值取反)

False注入为何叫False注入呢，是因为mysql存在隐式类型转换。抛开官方文档各种复杂的解释。最简单的就是mysql在进行比较运算的时候，如果将字符串与数字进行比较，就会将字符串进行类型进行转换，而这个转换会失败从而转为false。
举个栗子。
现在有个sql语句:select ‘a’ = false;
这个sql语句执行的时候’a’ ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/05/19/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%80%E8%A1%80%EF%BC%8CCBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-bmp%E9%9A%90%E5%86%99/" title="记一次一血，CBC字节翻转攻击/bmp隐写">     <img class="post_bg" src="https://z3.ax1x.com/2021/05/19/g4UEgP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记一次一血，CBC字节翻转攻击/bmp隐写"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/19/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%80%E8%A1%80%EF%BC%8CCBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-bmp%E9%9A%90%E5%86%99/" title="记一次一血，CBC字节翻转攻击/bmp隐写">记一次一血，CBC字节翻转攻击/bmp隐写</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-19T02:30:23.000Z" title="发表于 2021-05-19 10:30:23">2021-05-19</time></span></div><div class="content">ISCC客服一号冲冲冲（二）考点：CBC字节翻转攻击，bmp隐写
进入题目发现就给了一张图片，扫目录，看返回包，没有发现有用信息。


发现图片是个登录框，联想到手动传参登录。尝试get，post最后发现post可以成功发送登录请求，根据题目提示，账户为admin，密码为上一道题的flag：‘1SCC_2o2l_KeFuu’，我这里没用是因为只是为了掩饰，真正打的时候密码得用1SCC_2o2l_KeFuu，然后提示admin账户无法登录。


更换账户尝试，发现响应头中含有iv，cipher。属于CBC字节翻转攻击标志。


现在需要后端的加密源码，尝试寻找源码泄露途径。发现登陆的哪个图片是bmp格式的，bmp存在隐写。下载下来使用工具发现源码就藏在其中，红色部分为泄露的源码。


因为这个隐写只找出了这么点代码，就通过源码特征在网上搜到了全部源码。
整理后如下：
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/05/13/SSRF-gopher%E5%8D%8F%E8%AE%AE%E6%9E%84%E9%80%A0/" title="SSRF gopher协议构造">     <img class="post_bg" src="https://z3.ax1x.com/2021/05/19/g4UCAH.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSRF gopher协议构造"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/13/SSRF-gopher%E5%8D%8F%E8%AE%AE%E6%9E%84%E9%80%A0/" title="SSRF gopher协议构造">SSRF gopher协议构造</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-13T09:43:01.000Z" title="发表于 2021-05-13 17:43:01">2021-05-13</time></span></div><div class="content">SSRF利用中的万能协议gopher在一次CTF的SSRF利用中构造gopher协议对内网靶机构造post请求时出现了一些问题导致请求400，而原因大多都是构造出的gopher协议存在编码上的问题，现记录gopher协议构造方法。
gopher协议构造gopher协议请求包，回车换行使用%0d%0a，然后进行url编码后发包。其他与http协议类似。
下面按照此要求构造一个gopher请求包。
GOPHER://172.21.0.2:8080/_POST /login HTTP/1.1%0d%0aHost: localhost:1000%0d%0aConnection: close%0d%0aContent-Type: application/x-www-form-urlencoded%0d%0aContent-Length: 31%0d%0a%0d%0ausername=admin&amp;password=c9a5d20c9f84
往172.21.0.2:8080/login下发起post请求。带上必须要的http请求头字段，发起请求。
GET构造方式与其相似，下面贴上自动生成脚本 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://s3.ax1x.com/2021/01/15/s010Z4.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Mengd@</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Kumengda"><i class="fab fa-github"></i><span>访问我的github</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is Mengd@ Blog</div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/08/%E8%AE%B0%E4%B8%80%E6%AC%A1lmxcms%E5%AE%A1%E8%AE%A1/" title="记一次lmxcms审计"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记一次lmxcms审计"/></a><div class="content"><a class="title" href="/2022/06/08/%E8%AE%B0%E4%B8%80%E6%AC%A1lmxcms%E5%AE%A1%E8%AE%A1/" title="记一次lmxcms审计">记一次lmxcms审计</a><time datetime="2022-06-08T11:59:53.000Z" title="发表于 2022-06-08 19:59:53">2022-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/18/2022%E9%9D%A2%E7%BB%8F%E6%80%BB%E7%BB%93/" title="2022面经总结"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022面经总结"/></a><div class="content"><a class="title" href="/2022/04/18/2022%E9%9D%A2%E7%BB%8F%E6%80%BB%E7%BB%93/" title="2022面经总结">2022面经总结</a><time datetime="2022-04-18T14:19:43.000Z" title="发表于 2022-04-18 22:19:43">2022-04-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/17/Log4j-RCE%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="Log4j-RCE源码分析"><img src="https://s1.ax1x.com/2022/04/17/LUFaFK.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Log4j-RCE源码分析"/></a><div class="content"><a class="title" href="/2022/04/17/Log4j-RCE%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="Log4j-RCE源码分析">Log4j-RCE源码分析</a><time datetime="2022-04-17T06:08:44.000Z" title="发表于 2022-04-17 14:08:44">2022-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/17/shiro%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" title="shiro系列漏洞分析"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="shiro系列漏洞分析"/></a><div class="content"><a class="title" href="/2022/03/17/shiro%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" title="shiro系列漏洞分析">shiro系列漏洞分析</a><time datetime="2022-03-17T05:47:11.000Z" title="发表于 2022-03-17 13:47:11">2022-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/10/%E9%80%9A%E8%BF%87%E8%B0%83%E8%AF%95%E6%BA%90%E7%A0%81%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E6%9E%90RMI%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/" title="通过调试源码深入理解分析RMI运行机制(长文)"><img src="https://s1.ax1x.com/2022/03/14/bXLZLQ.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="通过调试源码深入理解分析RMI运行机制(长文)"/></a><div class="content"><a class="title" href="/2022/03/10/%E9%80%9A%E8%BF%87%E8%B0%83%E8%AF%95%E6%BA%90%E7%A0%81%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E6%9E%90RMI%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/" title="通过调试源码深入理解分析RMI运行机制(长文)">通过调试源码深入理解分析RMI运行机制(长文)</a><time datetime="2022-03-10T12:03:49.000Z" title="发表于 2022-03-10 20:03:49">2022-03-10</time></div></div></div></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/BUUCTF/" style="font-size: 1.1em; color: #999">BUUCTF</a> <a href="/tags/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/" style="font-size: 1.1em; color: #999">CBC字节翻转攻击</a> <a href="/tags/CTF/" style="font-size: 1.18em; color: #999ca1">CTF</a> <a href="/tags/CTF%E5%A4%8D%E7%8E%B0/" style="font-size: 1.1em; color: #999">CTF复现</a> <a href="/tags/Golang/" style="font-size: 1.1em; color: #999">Golang</a> <a href="/tags/JAVA/" style="font-size: 1.1em; color: #999">JAVA</a> <a href="/tags/JAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.1em; color: #999">JAVA反序列化</a> <a href="/tags/JAVA%E5%AE%89%E5%85%A8/" style="font-size: 1.42em; color: #99a6b7">JAVA安全</a> <a href="/tags/JAVA%E7%89%B9%E6%80%A7/" style="font-size: 1.1em; color: #999">JAVA特性</a> <a href="/tags/JNDI%E6%B3%A8%E5%85%A5/" style="font-size: 1.1em; color: #999">JNDI注入</a> <a href="/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.5em; color: #99a9bf">Java代码审计</a> <a href="/tags/Log4j/" style="font-size: 1.1em; color: #999">Log4j</a> <a href="/tags/PHP/" style="font-size: 1.1em; color: #999">PHP</a> <a href="/tags/RMI%E6%B3%A8%E5%85%A5/" style="font-size: 1.1em; color: #999">RMI注入</a> <a href="/tags/RMI%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 1.1em; color: #999">RMI源码分析</a> <a href="/tags/Redis/" style="font-size: 1.1em; color: #999">Redis</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 1.1em; color: #999">SQL注入</a> <a href="/tags/SSRF/" style="font-size: 1.18em; color: #999ca1">SSRF</a> <a href="/tags/Struts2/" style="font-size: 1.34em; color: #99a3b0">Struts2</a> <a href="/tags/Thinkphp5/" style="font-size: 1.26em; color: #999fa8">Thinkphp5</a> <a href="/tags/URLDNS/" style="font-size: 1.1em; color: #999">URLDNS</a> <a href="/tags/XDEBUG/" style="font-size: 1.1em; color: #999">XDEBUG</a> <a href="/tags/bmp%E9%9A%90%E5%86%99/" style="font-size: 1.1em; color: #999">bmp隐写</a> <a href="/tags/pwn%E5%85%A5%E9%97%A8/" style="font-size: 1.1em; color: #999">pwn入门</a> <a href="/tags/shiro/" style="font-size: 1.1em; color: #999">shiro</a> <a href="/tags/udf%E6%8F%90%E6%9D%83/" style="font-size: 1.1em; color: #999">udf提权</a> <a href="/tags/web/" style="font-size: 1.1em; color: #999">web</a> <a href="/tags/web%E5%AE%89%E5%85%A8/" style="font-size: 1.1em; color: #999">web安全</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.18em; color: #999ca1">代码审计</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/" style="font-size: 1.1em; color: #999">动态调试</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.18em; color: #999ca1">反序列化</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E5%8D%95%E8%AF%8D%E8%AE%B0%E5%BD%95/" style="font-size: 1.1em; color: #999">常用单词记录</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.26em; color: #999fa8">源码审计</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" style="font-size: 1.1em; color: #999">漏洞复现</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.1em; color: #999">面试</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/06/"><span class="card-archive-list-date">六月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">五月 2021</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives/">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">28</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-07-08T08:24:35.941Z"></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Mengd@</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script>function subtitleType () {
  $.getScript('https://sdk.jinrishici.com/v2/browser/jinrishici.js',function () {
    jinrishici.load(function (result) {
      if (true) {
        var sub = "Welcome To Mengd@ Blog".length == 0 ? new Array() : "Welcome To Mengd@ Blog".split(',')
        var content = result.data.content
        var both = sub.unshift(content)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = result.data.content
      }
    })
  })
}

if (true) {
  if (typeof Typed === 'function') subtitleType()
  else $.getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js', subtitleType)
} else {
  subtitleType()
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" async="async" mobile="false"></script></div></body></html>